{% extends "groups/group_base.html" %}
{% load i18n %}
{% load bootstrap_tags %}

{% block title %}{% trans "Manage Members" %}{% endblock %}
{% block subheader %}
<section id="subheader">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2>{{ group.title }}</h2>
	            <p><a href="{% url "group_detail" group.slug %}">Group info</a></p>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block body %}
<div class="row">
    <div class="col-md-8">
    	<ul class="list-group">
    		<li class="list-group-item">
				<p class="lead">{%  trans "Edit Members for Group"  %} <a href="{% url "group_detail" group.slug %}">{{ group.title }}</a></p>
				<ul class="nav nav-tabs">
					<li class="active"><a href="#all" data-toggle="tab"><i class=""></i>{% trans "All" %}</a></li>
					<li><a href="#managers" data-toggle="tab"><i class=""></i> {% trans "Managers" %}</a></li>
					<li><a href="#members" data-toggle="tab"><i class=""></i> {% trans "Members" %}</a></li>
				</ul>
				<div class="tab-content">
					<article id="all" class="tab-pane active">
						<ul class="no-style-list">
							{% for member in members %}
							<h4>
								<a href="{{ member.user.get_absolute_url }}">{{ member.user.username }}</a>
                				{% if member.user.email %}
                				<a href="mailto:{{ member.user.email }}"><i class="fa fa-envelope-o"></i></a>
                				{% endif %}
                				|
                				{% if member.role == 'manager' %}
                  			  	{% trans 'Manager' %}
                  			  	|
                				{% endif %}
                				<form style="display: inline;" method="POST" action="{% url "group_member_remove" group.slug member.user.username %}">
                  				    {% csrf_token %}
                  				  	<button type="submit" class="btn btn-danger btn-xs">{% trans 'Remove' %}</button>
                				</form>
              			    </h4>
              			  	<p>{% trans 'Role' %}: {{ member.role }}</p>
              			  	<hr>
            				{% endfor %}
            			</ul>
          		  	</article>
          		  	<article id="managers" class="tab-pane">
            		  	<ul class="no-style-list">
            			  	{% for member in members %}
              			  	{% if member.role = 'manager' %}
              			  	<h4>
                			  <a href="{{ member.user.get_absolute_url }}">{{ member.user.username }}</a>
                			  {% if member.user.email %}
                			  <a href="mailto:{{ member.user.email }}"><i class="fa fa-envelope-o"></i></a>
                			  {% endif %}
                			  |
                			  {% if member.role == 'manager' %}
                  			  {% trans 'Manager' %}
                  			  |
                			  {% endif %}
                			  <form style="display: inline;" method="POST" action="{% url "group_member_remove" group.slug member.user.username %}">
                  			      {% csrf_token %}
                  				  <button type="submit" class="btn btn-danger btn-xs">{% trans 'Remove' %}</button>
                			  </form>
              				</h4>
              			    <p>{% trans 'Role' %}: {{ member.role }}</p>
              			  	<hr>
              			  	{% endif %}
            				{% endfor %}
            			</ul>
          		    </article>
          		    <article id="members" class="tab-pane">
            			<ul class="no-style-list">
            				{% for member in members %}
              			  	{% if member.role = 'member' %}
              			  	<h4>
                				<a href="{{ member.user.get_absolute_url }}">{{ member.user.username }}</a>
                				{% if member.user.email %}
                				<a href="mailto:{{ member.user.email }}"><i class="fa fa-envelope-o"></i></a>
                				{% endif %}
                				|
                				{% if member.role == 'manager' %}
                  			  	{% trans 'Manager' %}
                  			  	|
                				{% endif %}
                				<form style="display: inline;" method="POST" action="{% url "group_member_remove" group.slug member.user.username %}">
                  				    {% csrf_token %}
                  				    <button type="submit" class="btn btn-danger btn-xs">{% trans 'Remove' %}</button>
                				</form>
              				</p>
              			  	<p>{% trans 'Role' %}: {{ member.role }}</p>
              			  	<hr>
              			    {% endif %}
            				{% endfor %}
            			</ul>
          		  </article>
        	  </div>
        	  {% if member_form %}
          	  <h3>{% trans "Add members" %}</h3>
          	  <form class="uniForm" method="POST" action="{% url "group_members_add" group.slug %}">
				  {% csrf_token %}
            	  <div id="member_form_container">
              	  {{ member_form|as_bootstrap }}<br/><br/>
            	  </div>
                  <input type="submit" value="Add Group Members" class="btn btn-success"/>
			  </form>
        	  {% endif %}

        	  {% if invite_form %}
			  <h3>{% trans "Invite people" %}</h3>
			  <form class="uniForm" method="POST" action="{% url "group_invite" group.slug %}">
				  {% csrf_token %}
				  {{ invite_form|as_bootstrap }}
				  <input type="submit" value="invite" />
			  </form>
			  {% endif %}
		  </li>
	  </ul>
	</div>
</div>
{% endblock %}

{% block extra_script %}
{% with "none" as layer %}
{% include "_permissions_form_js.html" %}
{% endwith %}
{% endblock extra_script %}
